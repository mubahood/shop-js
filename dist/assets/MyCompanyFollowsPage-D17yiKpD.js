import{r as a,j as e,ai as y,p as w,K as v,af as H,ac as D,ab as K,z as O,aj as M,ak as V,al as U,am as P,an as W,ao as f,_ as Y,M as h,L as q}from"./index-D3ojX_Fy.js";import{C as G}from"./CompanyFollow-D1pHJkoV.js";const J={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.3}},exit:{opacity:0,y:10}},T=a.memo(({follow:o,idx:c,currentPage:n,rowLoading:l,onUnfollowClick:r})=>{var t;const m=(n-1)*10+(c+1);return e.jsxs("tr",{children:[e.jsx("td",{children:l?e.jsx(y,{}):m}),e.jsx("td",{children:l?e.jsx(y,{width:120}):e.jsx("strong",{children:o.company_text||o.company_id})}),e.jsx("td",{children:l?e.jsx(y,{width:100}):(t=o.created_at)==null?void 0:t.split("T")[0]}),e.jsx("td",{children:l?e.jsx(y,{width:60}):e.jsx(w,{variant:"outline-danger",size:"sm",onClick:()=>r(o),children:"Unfollow"})})]})});T.displayName="CompanyFollowRow";const Q=({show:o,follow:c,loading:n,onClose:l,onConfirm:r})=>c?e.jsxs(h,{show:o,onHide:l,centered:!0,children:[e.jsx(h.Header,{className:"bg-danger text-white",closeButton:!0,children:e.jsx(h.Title,{children:"Unfollow Company"})}),e.jsx(h.Body,{children:e.jsxs("p",{children:["Are you sure you want to unfollow"," ",e.jsx("strong",{children:c.company_text||"this company"}),"?"]})}),e.jsxs(h.Footer,{children:[e.jsx(w,{variant:"secondary",onClick:l,disabled:n,children:"Cancel"}),e.jsx(w,{variant:"danger",onClick:r,disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx(U,{size:"sm",animation:"border",className:"me-2"}),"Removing..."]}):"Unfollow"})]})]}):null,$=()=>{const[o,c]=a.useState([]),[n,l]=a.useState(!1),[r,m]=a.useState(""),[t,g]=a.useState(1),[x,A]=a.useState(1),[d,E]=a.useState(""),[S,F]=a.useState(!1),[u,N]=a.useState(null),[L,k]=a.useState(!1),[R]=a.useState([]),p=a.useCallback(async(s,i)=>{l(!0),m("");try{const j={};i&&(j.search=i);const b=await G.fetchMyCompanyFollows(s,j);c(b.data),g(b.current_page),A(b.last_page)}catch(j){console.error(j),m("Failed to load followed companies."),v.error("Error loading data.")}finally{l(!1)}},[]);a.useEffect(()=>{p(t,d)},[p,t,d]);const C=s=>{s>=1&&s<=x&&g(s)},z=s=>{N(s),F(!0)},_=()=>{F(!1),N(null)},B=async()=>{if(u){k(!0);try{await q("/company-unfollow",{company_id:u.company_id}),v.success("Successfully unfollowed the company."),p(t,d)}catch(s){console.error(s),v.error("Failed to unfollow.")}finally{k(!1),_()}}},I=s=>{s.preventDefault(),g(1),p(1,d)};return e.jsxs(e.Fragment,{children:[e.jsx(H,{breadcrumbs:[{title:"My Followed Companies",path:"/my-company-follows",isActive:!0}],children:"My Followed Companies"}),e.jsxs(D,{children:[e.jsx(K,{}),e.jsx(O.div,{className:"container-fluid py-4 card shadow-sm",variants:J,initial:"hidden",animate:"visible",exit:"exit",children:e.jsxs("div",{className:"card-body",children:[e.jsx(M,{onSubmit:I,className:"row mb-3",autoComplete:"off",children:e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"input-group input-group-sm",children:[e.jsx("span",{className:"input-group-text bg-primary text-white",children:e.jsx(V,{})}),e.jsx(M.Control,{type:"text",placeholder:"Search by company name...",value:d,onChange:s=>E(s.target.value)}),e.jsx(w,{type:"submit",variant:"primary",children:"Search"})]})})}),n&&e.jsx("div",{className:"text-center py-5",children:e.jsx(U,{animation:"border",variant:"primary"})}),!n&&r&&e.jsx(P,{variant:"danger",children:r}),!n&&!r&&o.length===0&&e.jsx(P,{variant:"info",className:"text-center",children:"You have not followed any companies yet."}),!n&&!r&&o.length>0&&e.jsx("div",{className:"table-responsive",children:e.jsxs(W,{className:"table table-hover align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"50px"},children:"#"}),e.jsx("th",{children:"Company"}),e.jsx("th",{children:"Followed On"}),e.jsx("th",{style:{width:"100px"},children:"Actions"})]})}),e.jsx("tbody",{children:o.map((s,i)=>e.jsx(T,{follow:s,idx:i,currentPage:t,rowLoading:R.includes(i),onUnfollowClick:z},s.id))})]})}),!n&&!r&&x>1&&e.jsxs(f,{className:"mt-4 justify-content-center",children:[e.jsx(f.Prev,{onClick:()=>C(t-1),disabled:t<=1,children:"Previous"}),Array.from({length:x},(s,i)=>i+1).map(s=>e.jsx(f.Item,{active:s===t,onClick:()=>C(s),children:s},s)),e.jsx(f.Next,{onClick:()=>C(t+1),disabled:t>=x,children:"Next"})]})]})}),e.jsx(Y,{children:S&&u&&e.jsx(Q,{show:S,follow:u,loading:L,onClose:_,onConfirm:B})})]})]})};export{$ as default};
