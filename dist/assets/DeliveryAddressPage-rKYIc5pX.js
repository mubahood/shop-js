var e=Object.defineProperty,n=Object.defineProperties,r=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,s=(n,r,a)=>r in n?e(n,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[r]=a,i=(e,n,r)=>s(e,"symbol"!=typeof n?n+"":n,r),d=(e,n,r)=>new Promise(((a,o)=>{var t=e=>{try{i(r.next(e))}catch(n){o(n)}},s=e=>{try{i(r.throw(e))}catch(n){o(n)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(t,s);i((r=r.apply(e,n)).next())}));import{j as l,a as c,A as m,S as p,F as u,B as h}from"./vendor-bootstrap-D-I_tXzc.js";import{r as g}from"./vendor-react-BEzjZhyF.js";import{O as v}from"./OrderModel-CProAc5Z.js";import{U as x,y as b,q as f,g as y,z as _,T as j}from"./index-UqLlkq5m.js";import{f as w}from"./index-B0HgjlNw.js";import{O as N}from"./OrderModelUtils-B3GKBFxb.js";import{D as k}from"./DynamicBreadcrumb-C-1Qq4Fc.js";import"./vendor-redux-Dj4qHuPE.js";const O=class e{constructor(e={}){i(this,"id",0),i(this,"created_at",""),i(this,"updated_at",""),i(this,"address",""),i(this,"latitude",""),i(this,"longitude",""),i(this,"shipping_cost",""),Object.assign(this,e)}static fromJson(n){return n?new e({id:x.int_parse(n.id),created_at:x.to_str(n.created_at,""),updated_at:x.to_str(n.updated_at,""),address:x.to_str(n.address,""),latitude:x.to_str(n.latitude,""),longitude:x.to_str(n.longitude,""),shipping_cost:x.to_str(n.shipping_cost,"")}):new e}toJson(){return{id:this.id,created_at:this.created_at,updated_at:this.updated_at,address:this.address,latitude:this.latitude,longitude:this.longitude,shipping_cost:this.shipping_cost}}static getItems(){return d(this,null,(function*(){try{const n=yield b(e.end_point,{});return 1!==n.code?[]:Array.isArray(n.data)?n.data.map((n=>e.fromJson(n))):[]}catch(n){return[]}}))}getDisplayText(){return`${this.address} (${x.moneyFormat(this.shipping_cost)})`}};i(O,"end_point","delivery-addresses"),i(O,"tableName","delivery_addresses");let P=O;const C=()=>{const e=f(),i=y(),{order:b}=i.state||{},[O,C]=g.useState((()=>N.ensureOrderModel(b))),I=_(),[S,z]=g.useState([]),[E,D]=g.useState(!1),[Y,A]=g.useState(!0),[F,M]=g.useState(!1),[B,T]=g.useState({});g.useEffect((()=>{U()}),[I]);const U=()=>d(void 0,null,(function*(){try{if(A(!0),I&&I.length>0){const e=I.map((e=>{const n=new P;return n.id=e.id,n.address=e.name,n.shipping_cost=e.shipping_cost.toString(),n}));z(e)}else{const e=yield P.getItems();z(e)}}catch(e){j.error("Failed to load delivery addresses")}finally{A(!1)}})),H=(e,i)=>{const d=new v;Object.assign(d,O),d[e]=i,C(d),B[e]&&T((i=>{return d=((e,n)=>{for(var r in n||(n={}))o.call(n,r)&&s(e,r,n[r]);if(a)for(var r of a(n))t.call(n,r)&&s(e,r,n[r]);return e})({},i),n(d,r({[e]:""}));var d}))};return b?l.jsxs(l.Fragment,{children:[l.jsx("style",{dangerouslySetInnerHTML:{__html:"\n  .delivery-address-page {\n    min-height: 100vh;\n    background: var(--background-body);\n    position: relative;\n  }\n\n  .delivery-form-wrapper {\n    width: 100%;\n    min-height: 60vh;\n    background: var(--white);\n    border-radius: var(--border-radius);\n    box-shadow: var(--shadow-md);\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    padding: 0;\n    border: none;\n    transition: all 0.3s ease;\n  }\n\n  .delivery-form-wrapper.loading {\n    pointer-events: none;\n    opacity: 0.7;\n  }\n\n  .delivery-header {\n    padding: 32px 32px 0 32px;\n    text-align: center;\n    background: none;\n    border: none;\n  }\n\n  .delivery-title {\n    font-size: 1.6rem;\n    font-weight: 700;\n    color: var(--text-color-dark);\n    margin-bottom: 0.25rem;\n  }\n\n  .delivery-subtitle {\n    font-size: 1rem;\n    color: var(--text-color-medium);\n    margin-bottom: 0;\n  }\n\n  form {\n    padding: 32px;\n    background: none;\n    flex: 1 1 auto;\n    display: flex;\n    flex-direction: column;\n    gap: 16px;\n    justify-content: center;\n    position: relative;\n  }\n\n  .form-group-modern {\n    margin-bottom: 12px;\n    display: flex;\n    flex-direction: column;\n    gap: 4px;\n  }\n\n  .form-label-modern {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--text-color-dark);\n    margin-bottom: 2px;\n    text-transform: none;\n    letter-spacing: 0;\n  }\n\n  .form-control-modern {\n    font-size: 1rem !important;\n    border-radius: var(--border-radius) !important;\n    border: 1px solid var(--border-color) !important;\n    background: var(--white) !important;\n    padding: 10px 14px !important;\n    box-shadow: none !important;\n    font-weight: 400 !important;\n    transition: all 0.2s ease;\n  }\n\n  .form-control-modern:focus {\n    border-color: var(--primary-color) !important;\n    background: var(--background-light) !important;\n    outline: none !important;\n    box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.1) !important;\n    transform: translateY(-1px);\n  }\n\n  .form-control-modern:disabled {\n    opacity: 0.6;\n    cursor: not-allowed;\n  }\n\n  .error-message {\n    color: var(--danger-color);\n    font-size: 0.9rem;\n    margin-top: 4px;\n    font-weight: 500;\n    background: none;\n    border: none;\n    padding: 0;\n    animation: fadeInError 0.3s ease;\n  }\n\n  @keyframes fadeInError {\n    from { opacity: 0; transform: translateY(-5px); }\n    to { opacity: 1; transform: translateY(0); }\n  }\n\n  .delivery-actions {\n    display: flex;\n    justify-content: center;\n    gap: 16px;\n    padding: 32px 0 0 0;\n    background: none;\n    border: none;\n  }\n\n  .btn-back {\n    font-size: 1rem;\n    color: var(--primary-color);\n    background: var(--white);\n    border: 1px solid var(--primary-color);\n    border-radius: var(--border-radius);\n    min-width: 120px;\n    font-weight: 500;\n    transition: all 0.2s ease;\n    position: relative;\n    overflow: hidden;\n  }\n\n  .btn-back:hover:not(:disabled) {\n    background: var(--primary-color);\n    color: var(--white);\n    transform: translateY(-1px);\n    box-shadow: 0 4px 12px rgba(13, 110, 253, 0.2);\n  }\n\n  .btn-back:disabled {\n    opacity: 0.6;\n    cursor: not-allowed;\n    pointer-events: none;\n  }\n\n  .btn-continue {\n    font-size: 1rem;\n    font-weight: 600;\n    border-radius: var(--border-radius);\n    background: var(--primary-color);\n    color: var(--white);\n    border: none;\n    min-width: 180px;\n    min-height: 42px;\n    transition: all 0.2s ease;\n    position: relative;\n    overflow: hidden;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .btn-continue:hover:not(:disabled) {\n    background: var(--primary-color-dark);\n    color: var(--white);\n    transform: translateY(-1px);\n    box-shadow: 0 4px 12px rgba(13, 110, 253, 0.3);\n  }\n\n  .btn-continue:disabled {\n    opacity: 0.7;\n    cursor: not-allowed;\n    pointer-events: none;\n  }\n\n  .btn-continue.loading {\n    pointer-events: none;\n  }\n\n  .loading-spinner {\n    width: 18px;\n    height: 18px;\n    margin-right: 8px;\n  }\n\n  .loading-overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.4);\n    backdrop-filter: blur(4px);\n    z-index: 9999;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    animation: fadeInOverlay 0.3s ease;\n  }\n\n  @keyframes fadeInOverlay {\n    from { opacity: 0; }\n    to { opacity: 1; }\n  }\n\n  .loading-content {\n    background: white;\n    padding: 32px;\n    border-radius: 12px;\n    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);\n    text-align: center;\n    min-width: 280px;\n    animation: slideInUp 0.3s ease;\n  }\n\n  @keyframes slideInUp {\n    from { opacity: 0; transform: translateY(30px); }\n    to { opacity: 1; transform: translateY(0); }\n  }\n\n  .loading-spinner-large {\n    width: 40px;\n    height: 40px;\n    margin-bottom: 16px;\n    color: var(--primary-color);\n  }\n\n  .loading-text {\n    font-size: 1.1rem;\n    font-weight: 600;\n    color: var(--text-color-dark);\n    margin-bottom: 8px;\n  }\n\n  .loading-subtext {\n    font-size: 0.95rem;\n    color: var(--text-color-medium);\n    margin: 0;\n  }\n\n  .region-loading {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 16px;\n    background: var(--background-light);\n    border-radius: var(--border-radius);\n    border: 1px solid var(--border-color);\n  }\n\n  .region-loading-spinner {\n    width: 20px;\n    height: 20px;\n    margin-right: 12px;\n    color: var(--primary-color);\n  }\n\n  .region-loading-text {\n    font-size: 0.95rem;\n    color: var(--text-color-medium);\n    font-weight: 500;\n  }\n\n  @media (max-width: 575.98px) {\n    .delivery-form-wrapper, .delivery-header, form, .delivery-actions {\n      padding: 16px !important;\n    }\n    .delivery-title {\n      font-size: 1.3rem;\n    }\n    .delivery-actions {\n      flex-direction: column;\n    }\n    .btn-back, .btn-continue {\n      width: 100%;\n      min-width: auto;\n    }\n    .loading-content {\n      margin: 20px;\n      min-width: auto;\n      width: calc(100% - 40px);\n    }\n  }\n"}}),l.jsx(k,{showBackground:!0,showIcons:!0}),F&&l.jsx("div",{className:"loading-overlay",children:l.jsxs("div",{className:"loading-content",children:[l.jsx(p,{className:"loading-spinner-large",animation:"border"}),l.jsx("div",{className:"loading-text",children:"Processing Your Information"}),l.jsx("div",{className:"loading-subtext",children:"Preparing your checkout..."})]})}),l.jsx("div",{className:"delivery-address-page",children:l.jsx(c,{className:"d-flex flex-column justify-content-center align-items-center",style:{minHeight:"100vh"},children:l.jsxs("div",{className:"delivery-form-wrapper w-100 "+(F?"loading":""),style:{minHeight:"60vh",display:"flex",flexDirection:"column",justifyContent:"center"},children:[l.jsxs("div",{className:"delivery-header",children:[l.jsx("h2",{className:"delivery-title",children:"Delivery Information"}),l.jsx("p",{className:"delivery-subtitle",children:"Please provide your delivery details"})]}),l.jsxs(u,{onSubmit:n=>d(void 0,null,(function*(){if(n.preventDefault(),(()=>{const e={};return O.delivery_address_id||(e.delivery_address_id="Please select a delivery region"),(!O.delivery_address_details||O.delivery_address_details.length<5)&&(e.delivery_address_details="Please enter a clear address"),(!O.customer_name||O.customer_name.trim().length<2)&&(e.customer_name="Please enter your name"),O.mail&&x.isValidMail(O.mail)||(e.mail="Please enter a valid email address"),(!O.customer_phone_number_1||O.customer_phone_number_1.length<10)&&(e.customer_phone_number_1="Please enter a valid phone number"),O.customer_phone_number_1&&O.customer_phone_number_1.startsWith("+")&&(e.customer_phone_number_1="Phone number should not start with +"),T(e),0===Object.keys(e).length})())try{M(!0),D(!0),yield new Promise((e=>setTimeout(e,800))),e("/checkout",{state:{order:O}})}catch(r){j.error("Failed to proceed to checkout")}finally{M(!1),D(!1)}else j.error("Please fix the errors below")})),children:[l.jsxs("div",{className:"form-group-modern",children:[l.jsx("label",{className:"form-label-modern",children:"Delivery Region *"}),Y?l.jsxs("div",{className:"region-loading",children:[l.jsx(p,{className:"region-loading-spinner",animation:"border",size:"sm"}),l.jsx("span",{className:"region-loading-text",children:"Loading delivery regions..."})]}):l.jsxs(u.Select,{value:O.delivery_address_id,onChange:e=>(e=>{const n=S.find((n=>n.id.toString()===e));if(n){const e=new v;Object.assign(e,O),e.delivery_address_id=n.id.toString(),e.delivery_address_text=n.address,e.delivery_amount=n.shipping_cost,C(e)}})(e.target.value),isInvalid:!!B.delivery_address_id,disabled:F,className:"form-control-modern",children:[l.jsx("option",{value:"",children:"Select a delivery region"}),S.map((e=>l.jsxs("option",{value:e.id.toString(),children:[e.address," - ",w(e.shipping_cost)]},e.id)))]}),B.delivery_address_id&&l.jsx("div",{className:"error-message",children:B.delivery_address_id})]}),l.jsxs("div",{className:"form-group-modern",children:[l.jsx("label",{className:"form-label-modern",children:"Street Address *"}),l.jsx(u.Control,{type:"text",value:O.delivery_address_details,onChange:e=>H("delivery_address_details",e.target.value),placeholder:"Enter your street address",isInvalid:!!B.delivery_address_details,disabled:F,className:"form-control-modern"}),B.delivery_address_details&&l.jsx("div",{className:"error-message",children:B.delivery_address_details})]}),l.jsxs("div",{className:"form-group-modern",children:[l.jsx("label",{className:"form-label-modern",children:"Full Name *"}),l.jsx(u.Control,{type:"text",value:O.customer_name,onChange:e=>H("customer_name",e.target.value),placeholder:"Enter your full name",isInvalid:!!B.customer_name,disabled:F,className:"form-control-modern"}),B.customer_name&&l.jsx("div",{className:"error-message",children:B.customer_name})]}),l.jsxs("div",{className:"form-group-modern",children:[l.jsx("label",{className:"form-label-modern",children:"Email Address *"}),l.jsx(u.Control,{type:"email",value:O.mail,onChange:e=>H("mail",e.target.value),placeholder:"Enter your email address",isInvalid:!!B.mail,disabled:F,className:"form-control-modern"}),B.mail&&l.jsx("div",{className:"error-message",children:B.mail})]}),l.jsxs("div",{className:"form-group-modern",children:[l.jsx("label",{className:"form-label-modern",children:"Phone Number *"}),l.jsx(u.Control,{type:"tel",value:O.customer_phone_number_1,onChange:e=>H("customer_phone_number_1",e.target.value),placeholder:"Enter your phone number",isInvalid:!!B.customer_phone_number_1,disabled:F,className:"form-control-modern"}),B.customer_phone_number_1&&l.jsx("div",{className:"error-message",children:B.customer_phone_number_1})]}),l.jsxs("div",{className:"form-group-modern",children:[l.jsx("label",{className:"form-label-modern",children:"Alternate Phone Number"}),l.jsx(u.Control,{type:"tel",value:O.customer_phone_number_2,onChange:e=>H("customer_phone_number_2",e.target.value),placeholder:"Enter alternate phone number (optional)",disabled:F,className:"form-control-modern"})]}),l.jsxs("div",{className:"form-group-modern",children:[l.jsx("label",{className:"form-label-modern",children:"Order Notes"}),l.jsx(u.Control,{as:"textarea",rows:3,value:O.order_details,onChange:e=>H("order_details",e.target.value),placeholder:"Any special instructions for delivery (optional)",disabled:F,className:"form-control-modern"})]}),l.jsxs("div",{className:"delivery-actions",children:[l.jsx(h,{variant:"outline-secondary",onClick:()=>e("/cart"),disabled:F,className:"btn-back",children:"Back to Cart"}),l.jsx(h,{type:"submit",disabled:E||F,className:"btn-continue "+(F?"loading":""),children:F?l.jsxs(l.Fragment,{children:[l.jsx(p,{size:"sm",className:"loading-spinner",animation:"border"}),"Processing..."]}):"Continue to Checkout"})]})]})]})})})]}):l.jsx(c,{className:"py-5",children:l.jsx(m,{variant:"warning",children:"No order information found. Please start from the cart."})})};export{C as default};
