var e=Object.defineProperty,s=Object.defineProperties,r=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(s,r,a)=>r in s?e(s,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[r]=a,i=(e,s)=>{for(var r in s||(s={}))t.call(s,r)&&n(e,r,s[r]);if(a)for(var r of a(s))o.call(s,r)&&n(e,r,s[r]);return e},l=(e,a)=>s(e,r(a)),d=(e,s,r)=>new Promise(((a,t)=>{var o=e=>{try{i(r.next(e))}catch(s){t(s)}},n=e=>{try{i(r.throw(e))}catch(s){t(s)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(o,n);i((r=r.apply(e,s)).next())}));import{j as c,A as m,F as p,B as u,S as x}from"./vendor-bootstrap-D-I_tXzc.js";import{r as g,R as h}from"./vendor-react-BEzjZhyF.js";import{q as y,L as w,K as v,R as j,V as f}from"./index--azPsTEf.js";import{u as b}from"./vendor-redux-Dj4qHuPE.js";const P=()=>{const e=y(),s=b(),[r,a]=g.useState("request"),[t,o]=g.useState(""),[n,P]=g.useState({email:""}),[N,C]=g.useState({email:"",code:"",newPassword:"",confirmPassword:""}),[S,k]=g.useState({}),[E,z]=g.useState(!1),[R,q]=g.useState(""),[F,I]=g.useState("");h.useEffect((()=>(document.body.style.paddingTop="0",()=>{document.body.style.paddingTop="calc(56px + 35px + 0px)"})),[]);const O=e=>{const{name:s,value:a}=e.target;"request"===r?P((e=>l(i({},e),{[s]:a}))):C((e=>l(i({},e),{[s]:a}))),S[s]&&k((e=>l(i({},e),{[s]:void 0}))),R&&q(""),F&&I("")},B={minHeight:"100vh",background:"linear-gradient(135deg, var(--primary-color), var(--primary-color-dark))",display:"flex",margin:0,padding:0},T={flex:1,display:"flex",alignItems:"center",justifyContent:"center",color:"white",padding:"var(--spacing-6)",textAlign:"center",background:"linear-gradient(135deg, var(--primary-color) 0%, var(--primary-color-dark) 100%)"};return c.jsxs("div",{style:B,children:[c.jsx("div",{style:T,className:"d-none d-lg-flex",children:c.jsxs("div",{children:[c.jsx(w,{to:"/",className:"text-white text-decoration-none mb-4 d-block",children:c.jsx("img",{src:"/media/logos/logo-white.png",alt:v.NAME,style:{maxHeight:"60px",marginBottom:"var(--spacing-lg)"},onError:e=>{e.currentTarget.src="/media/logos/logo.png",e.currentTarget.style.filter="brightness(0) invert(1)"}})}),c.jsx("h1",{style:{fontSize:"var(--font-size-3xl)",fontWeight:"bold",marginBottom:"var(--spacing-lg)",color:"white"},children:"request"===r?"Forgot Password?":"Reset Password"}),c.jsx("p",{style:{fontSize:"var(--font-size-lg)",opacity:.9,marginBottom:"var(--spacing-xl)",lineHeight:1.6},children:"request"===r?"Don't worry! It happens. Please enter your email address and we'll send you a reset code.":"Enter the reset code sent to your email along with your new password."}),c.jsxs("div",{style:{marginTop:"var(--spacing-xl)"},children:[c.jsxs("div",{style:{marginBottom:"var(--spacing-md)",display:"flex",alignItems:"center",justifyContent:"center",gap:"var(--spacing-sm)"},children:[c.jsx("i",{className:"bi bi-shield-check",style:{fontSize:"var(--font-size-xl)"}}),c.jsx("span",{children:"Secure Password Recovery"})]}),c.jsxs("div",{style:{marginBottom:"var(--spacing-md)",display:"flex",alignItems:"center",justifyContent:"center",gap:"var(--spacing-sm)"},children:[c.jsx("i",{className:"bi bi-envelope",style:{fontSize:"var(--font-size-xl)"}}),c.jsx("span",{children:"Email Verification Required"})]}),c.jsxs("div",{style:{marginBottom:"var(--spacing-md)",display:"flex",alignItems:"center",justifyContent:"center",gap:"var(--spacing-sm)"},children:[c.jsx("i",{className:"bi bi-clock",style:{fontSize:"var(--font-size-xl)"}}),c.jsx("span",{children:"Quick & Easy Process"})]})]})]})}),c.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"var(--bg-white)",padding:"var(--spacing-6)",margin:0},children:c.jsxs("div",{style:{width:"100%",maxWidth:"400px",padding:0},children:[c.jsx("div",{className:"text-center mb-4 d-lg-none",children:c.jsx(w,{to:"/",children:c.jsx("img",{src:"/media/logos/logo.png",alt:v.NAME,style:{maxHeight:"50px"},onError:e=>{e.currentTarget.style.display="none"}})})}),c.jsxs("div",{className:"text-center mb-4",children:[c.jsx("h2",{className:"h3 fw-bold",children:"request"===r?"Forgot Password":"Reset Password"}),c.jsx("p",{className:"text-muted",children:"request"===r?"Enter your email to receive a reset code":`Enter the code sent to ${t}`})]}),R&&c.jsx(m,{variant:"danger",className:"mb-4",children:R}),F&&c.jsx(m,{variant:"success",className:"mb-4",children:F}),"request"===r?c.jsxs(p,{onSubmit:e=>d(void 0,null,(function*(){if(e.preventDefault(),(()=>{const e={};return n.email?/\S+@\S+\.\S+/.test(n.email)||(e.email="Please enter a valid email"):e.email="Email is required",k(e),0===Object.keys(e).length})()){z(!0),k({}),q(""),I("");try{const e=yield s(j(n.email));if(!e.success)throw new Error(e.error||"Failed to send password reset email");I(e.message||"Password reset code sent to your email"),o(n.email),C((e=>l(i({},e),{email:n.email}))),a("reset")}catch(r){const e=(null==r?void 0:r.message)||r||"Failed to send password reset email. Please try again.";q(e)}finally{z(!1)}}})),children:[c.jsxs(p.Group,{className:"mb-3",children:[c.jsx(p.Label,{children:"Email Address"}),c.jsx(p.Control,{type:"email",name:"email",value:n.email,onChange:O,isInvalid:!!S.email,placeholder:"Enter your email address",autoComplete:"email"}),c.jsx(p.Control.Feedback,{type:"invalid",children:S.email})]}),c.jsx(u,{type:"submit",variant:"primary",size:"lg",className:"w-100 mb-4",disabled:E,style:{backgroundColor:"var(--primary-color)",borderColor:"var(--primary-color)",borderRadius:"var(--border-radius)"},children:E?c.jsxs(c.Fragment,{children:[c.jsx(x,{size:"sm",className:"me-2"}),"Sending reset code..."]}):"Send Reset Code"}),c.jsxs("div",{className:"text-center",children:[c.jsx("span",{className:"text-muted",children:"Remember your password? "}),c.jsx(w,{to:"/auth/login",className:"text-decoration-none fw-semibold",style:{color:"var(--primary-color)"},children:"Sign in"})]})]}):c.jsxs(p,{onSubmit:r=>d(void 0,null,(function*(){if(r.preventDefault(),(()=>{const e={};return N.code?N.code.length<3&&(e.code="Please enter a valid reset code"):e.code="Reset code is required",N.newPassword?N.newPassword.length<4&&(e.newPassword="Password must be at least 4 characters"):e.newPassword="Password is required",N.confirmPassword?N.newPassword!==N.confirmPassword&&(e.confirmPassword="Passwords do not match"):e.confirmPassword="Please confirm your password",k(e),0===Object.keys(e).length})()){z(!0),k({}),q(""),I("");try{const r=yield s(f(N.email,N.code,N.newPassword));if(!r.success)throw new Error(r.error||"Failed to reset password");I(r.message||"Password reset successfully"),setTimeout((()=>{e("/auth/login")}),2e3)}catch(a){const e=(null==a?void 0:a.message)||a||"Failed to reset password. Please try again.";q(e)}finally{z(!1)}}})),children:[c.jsxs(p.Group,{className:"mb-3",children:[c.jsx(p.Label,{children:"Reset Code"}),c.jsx(p.Control,{type:"text",name:"code",value:N.code,onChange:O,isInvalid:!!S.code,placeholder:"Enter the reset code from your email"}),c.jsx(p.Control.Feedback,{type:"invalid",children:S.code})]}),c.jsxs(p.Group,{className:"mb-3",children:[c.jsx(p.Label,{children:"New Password"}),c.jsx(p.Control,{type:"password",name:"newPassword",value:N.newPassword,onChange:O,isInvalid:!!S.newPassword,placeholder:"Enter your new password",autoComplete:"new-password"}),c.jsx(p.Control.Feedback,{type:"invalid",children:S.newPassword})]}),c.jsxs(p.Group,{className:"mb-3",children:[c.jsx(p.Label,{children:"Confirm New Password"}),c.jsx(p.Control,{type:"password",name:"confirmPassword",value:N.confirmPassword,onChange:O,isInvalid:!!S.confirmPassword,placeholder:"Confirm your new password",autoComplete:"new-password"}),c.jsx(p.Control.Feedback,{type:"invalid",children:S.confirmPassword})]}),c.jsx(u,{type:"submit",variant:"primary",size:"lg",className:"w-100 mb-4",disabled:E,style:{backgroundColor:"var(--primary-color)",borderColor:"var(--primary-color)",borderRadius:"var(--border-radius)"},children:E?c.jsxs(c.Fragment,{children:[c.jsx(x,{size:"sm",className:"me-2"}),"Resetting password..."]}):"Reset Password"}),c.jsxs("div",{className:"text-center",children:[c.jsx("span",{className:"text-muted",children:"Need a new code? "}),c.jsx(w,{to:"#",className:"text-decoration-none fw-semibold",style:{color:"var(--primary-color)"},onClick:e=>{e.preventDefault(),a("request"),k({}),q(""),I("")},children:"Request again"})]})]}),c.jsx("div",{className:"text-center mt-4",children:c.jsxs(w,{to:"/",className:"text-muted text-decoration-none",style:{fontSize:"var(--font-size-sm)"},children:[c.jsx("i",{className:"bi bi-arrow-left"})," ","Back to Shopping"]})})]})})]})};export{P as default};
