import{r as n,j as e,ap as $,ai as b,p as j,K as C,af as G,ab as K,ac as U,z as q,aj as g,ak as Q,al as B,am as O,an as X,ao as w,_ as Z,M as o,L as ee}from"./index-D3ojX_Fy.js";import{J as se}from"./JobOffer-BNPUsv3A.js";const te={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.3}},exit:{opacity:0,y:10}},P=n.memo(({status:a})=>{let s="secondary";switch(a){case"Pending":s="warning";break;case"Accepted":s="success";break;case"Declined":s="danger";break;default:s="secondary";break}return e.jsx($,{bg:s,children:a})});P.displayName="StatusBadge";const z=n.memo(({offer:a,idx:s,currentPage:i,rowLoading:c,onViewDetails:l,onRespond:u})=>{const r=(i-1)*10+(s+1);return e.jsxs("tr",{children:[e.jsx("td",{children:c?e.jsx(b,{}):r}),e.jsx("td",{children:c?e.jsx(b,{width:120}):e.jsx(e.Fragment,{children:a.company_name||a.company_text||"N/A"})}),e.jsx("td",{children:c?e.jsx(b,{width:120}):e.jsx(e.Fragment,{children:a.job_title||"No Title"})}),e.jsx("td",{children:c?e.jsx(b,{width:60}):e.jsx(P,{status:a.status})}),e.jsx("td",{children:c?e.jsx(b,{width:100}):a.created_at?a.created_at.split("T")[0]:"N/A"}),e.jsxs("td",{children:[c?e.jsx(b,{width:70}):e.jsx(j,{variant:"outline-primary",size:"sm",onClick:()=>l(a),children:"View"})," ",c||a.status!=="Pending"?null:e.jsx(j,{variant:"primary",size:"sm",onClick:()=>u(a),children:"Respond"})]})]})});z.displayName="JobOfferRow";const ae=({show:a,offer:s,onClose:i})=>s?e.jsxs(o,{show:a,onHide:i,size:"lg",centered:!0,children:[e.jsx(o.Header,{closeButton:!0,children:e.jsx(o.Title,{children:"Job Offer Details"})}),e.jsxs(o.Body,{children:[e.jsx("h5",{className:"text-primary mb-3",children:s.job_title||"No Title"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Company:"})," ",s.company_name||s.company_text]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Salary:"})," ",s.salary||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Start Date:"})," ",s.start_date?s.start_date.split("T")[0]:"N/A"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Job Description:"}),e.jsx("div",{className:"bg-light p-2 rounded mt-1",style:{whiteSpace:"pre-wrap"},children:s.job_description||"No description provided."})]}),e.jsx("hr",{}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",e.jsx(P,{status:s.status})]}),s.candidate_message&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{children:e.jsx("strong",{children:"Your Message:"})}),e.jsx("div",{className:"bg-light p-2 rounded",children:s.candidate_message||"No message provided."})]})]}),e.jsx(o.Footer,{children:e.jsx(j,{variant:"secondary",onClick:i,children:"Close"})})]}):null,ne=({show:a,offer:s,onClose:i,onResponseSubmitted:c})=>{const[l,u]=n.useState(""),[r,p]=n.useState(null),[d,f]=n.useState(!1),[h,y]=n.useState("");n.useEffect(()=>{s&&(u(""),p(null),y(""))},[s]);const _=async()=>{if(!r||!s){C.error("Please select Accept or Decline.");return}f(!0),y("");try{const x=r==="accept"?"Accepted":"Declined",v={status:x,candidate_message:l.trim()};await ee(`/job-offers/${s.id}?_method=PUT`,v),C.success(`Job offer ${x.toLowerCase()} successfully!`),i(),c()}catch(x){console.error("Error updating job offer:",x),y("Failed to update the job offer. "+(x.message||"Please check your connection and try again.")),C.error("Failed to update job offer.")}finally{f(!1)}};return s?e.jsxs(o,{show:a,onHide:i,centered:!0,children:[e.jsx(o.Header,{closeButton:!0,children:e.jsx(o.Title,{children:"Respond to Job Offer"})}),e.jsxs(o.Body,{children:[h&&e.jsx(O,{variant:"danger",children:h}),e.jsxs("p",{children:["You are responding to:",e.jsx("br",{}),e.jsx("strong",{children:s.job_title})," at"," ",e.jsx("strong",{children:s.company_name||s.company_text})]}),e.jsx("hr",{}),e.jsxs("div",{className:"mb-3",children:[e.jsx(g.Label,{className:"fw-semibold",children:"Message (optional)"}),e.jsx(g.Control,{as:"textarea",rows:3,placeholder:"Write a short message (e.g., additional notes).",value:l,onChange:x=>u(x.target.value)})]}),e.jsxs("div",{className:"d-flex justify-content-between mt-4",children:[e.jsx(j,{variant:"outline-success",onClick:()=>p("accept"),active:r==="accept",children:"Accept"}),e.jsx(j,{variant:"outline-danger",onClick:()=>p("decline"),active:r==="decline",children:"Decline"})]})]}),e.jsxs(o.Footer,{children:[e.jsx(j,{variant:"secondary",onClick:i,disabled:d,children:"Cancel"}),e.jsxs(j,{variant:"primary",onClick:_,disabled:d||!r,children:[d?e.jsx(B,{animation:"border",size:"sm",as:"span"}):"Submit Response"," "]})]})]}):null},ce=()=>{const[a,s]=n.useState([]),[i,c]=n.useState(!1),[l,u]=n.useState(""),[r,p]=n.useState(1),[d,f]=n.useState(1),[h,y]=n.useState(""),[_,x]=n.useState([]),[v,R]=n.useState(null),[A,T]=n.useState(null),[J,F]=n.useState(!1),[D,E]=n.useState(!1),S=n.useCallback(async(t,m)=>{c(!0),u("");try{const N={};m&&(N.search=m);const k=await se.fetchMyOffers(t,N);s(k.data),p(k.current_page),f(k.last_page)}catch(N){console.error("API Error fetching job offers:",N),u("Failed to load job offers. Please check your connection."),C.error("Failed to load job offers.")}finally{c(!1)}},[]);n.useEffect(()=>{S(r,h)},[S,r,h]);const I=t=>{t.preventDefault(),p(1),S(1,h)},M=t=>{t>=1&&t<=d&&p(t)},H=t=>{R(t),F(!0)},L=()=>{F(!1),R(null)},Y=t=>{T(t),E(!0)},V=()=>{E(!1),T(null)},W=()=>{V(),S(r,h)};return e.jsxs(e.Fragment,{children:[e.jsx(G,{breadcrumbs:[{title:"My Job Offers",path:"/my-job-offers",isActive:!0}],children:"My Job Offers"}),e.jsx(K,{}),e.jsxs(U,{children:[e.jsx(q.div,{className:"container-fluid py-4 card shadow-sm",variants:te,initial:"hidden",animate:"visible",exit:"exit",children:e.jsxs("div",{className:"card-body",children:[e.jsx(g,{onSubmit:I,className:"row mb-3",autoComplete:"off",children:e.jsx("div",{className:"col-md-4",children:e.jsxs(g.Group,{className:"input-group input-group-sm",children:[e.jsx("span",{className:"input-group-text bg-primary text-white",children:e.jsx(Q,{})}),e.jsx(g.Control,{type:"text",placeholder:"Search by job or company...",value:h,onChange:t=>y(t.target.value)}),e.jsx(j,{type:"submit",variant:"primary",children:"Search"})]})})}),i&&e.jsx("div",{className:"text-center py-5",children:e.jsx(B,{animation:"border",variant:"primary"})}),!i&&l&&e.jsx(O,{variant:"danger",className:"text-center",children:l}),!i&&!l&&a.length===0&&e.jsx(O,{variant:"info",className:"text-center",children:"You have no job offers yet."}),!i&&!l&&a.length>0&&e.jsx("div",{className:"table-responsive",children:e.jsxs(X,{striped:!0,hover:!0,className:"align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Company"}),e.jsx("th",{children:"Job Title"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:a.map((t,m)=>e.jsx(z,{offer:t,idx:m,currentPage:r,rowLoading:_.includes(m),onViewDetails:H,onRespond:Y},t.id))})]})}),!i&&!l&&d>1&&e.jsxs(w,{className:"mt-4 justify-content-center",children:[e.jsx(w.Prev,{onClick:()=>M(r-1),disabled:r<=1,children:"Previous"}),Array.from({length:d},(t,m)=>m+1).map(t=>e.jsx(w.Item,{active:t===r,onClick:()=>M(t),children:t},t)),e.jsx(w.Next,{onClick:()=>M(r+1),disabled:r>=d,children:"Next"})]})]})}),e.jsxs(Z,{children:[J&&v&&e.jsx(ae,{show:J,offer:v,onClose:L}),D&&A&&e.jsx(ne,{show:D,offer:A,onClose:V,onResponseSubmitted:W})]})]})]})};export{ce as default};
