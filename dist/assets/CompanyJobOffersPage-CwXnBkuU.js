import{R as F,j as e,ap as K,ai as p,p as f,r as n,K as E,af as U,ab as W,ac as Y,z as $,ak as q,al as Q,am as w,an as X,ao as y,_ as Z,M as d,aj as S,L as ee}from"./index-D3ojX_Fy.js";import{J as se}from"./JobOffer-BNPUsv3A.js";const ae={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.3}},exit:{opacity:0,y:10}},O=F.memo(({status:t})=>{let s="secondary";switch(t){case"Pending":s="warning";break;case"Accepted":s="success";break;case"Declined":s="danger";break;case"Cancelled":s="dark";break;default:s="secondary";break}return e.jsx(K,{bg:s,children:t})});O.displayName="StatusBadge";const D=F.memo(({offer:t,idx:s,currentPage:l,rowLoading:i,onViewOffer:c,onCancelOffer:x})=>{var o;const r=(l-1)*10+(s+1);return e.jsxs("tr",{children:[e.jsx("td",{children:i?e.jsx(p,{}):r}),e.jsx("td",{children:i?e.jsx(p,{width:120}):t.job_title||"No Title"}),e.jsx("td",{children:i?e.jsx(p,{width:120}):t.candidate_text||t.candidate_id}),e.jsx("td",{children:i?e.jsx(p,{width:60}):e.jsx(O,{status:t.status})}),e.jsx("td",{children:i?e.jsx(p,{width:100}):((o=t.created_at)==null?void 0:o.split("T")[0])||"N/A"}),e.jsxs("td",{children:[i?e.jsx(p,{width:70}):e.jsx(f,{variant:"outline-primary",size:"sm",onClick:()=>c(t),children:"View"})," ",i||t.status!=="Pending"?null:e.jsx(f,{variant:"danger",size:"sm",onClick:()=>x(t),children:"Cancel"})]})]})});D.displayName="JobOfferRow";const te=({show:t,offer:s,onClose:l})=>s?e.jsxs(d,{show:t,onHide:l,size:"lg",centered:!0,children:[e.jsx(d.Header,{closeButton:!0,children:e.jsx(d.Title,{children:"Job Offer Details"})}),e.jsxs(d.Body,{children:[e.jsx("h5",{className:"text-primary mb-3",children:s.job_title||"No Title"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Candidate ID/Text:"})," ",s.candidate_text||s.candidate_id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Salary:"})," ",s.salary||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Start Date:"})," ",s.start_date?s.start_date.split("T")[0]:"N/A"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Job Description:"}),e.jsx("div",{className:"bg-light p-2 rounded mt-1",style:{whiteSpace:"pre-wrap"},children:s.job_description||"No description provided."})]}),e.jsx("hr",{}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",e.jsx(O,{status:s.status})]}),s.candidate_message&&e.jsxs(e.Fragment,{children:[e.jsx("h6",{className:"mt-3",children:"Candidateâ€™s Message"}),e.jsx("div",{className:"bg-light p-2 rounded",children:s.candidate_message||"No message provided."})]})]}),e.jsx(d.Footer,{children:e.jsx(f,{variant:"secondary",onClick:l,children:"Close"})})]}):null,ne=({show:t,offer:s,onClose:l,onCancelConfirmed:i})=>{const[c,x]=n.useState(""),[r,o]=n.useState(!1),[j,b]=n.useState("");n.useEffect(()=>{s&&(x(""),b(""))},[s]);const u=async()=>{if(s){o(!0),b("");try{const h={status:"Cancelled",candidate_message:c.trim()};await ee(`/job-offers/${s.id}?_method=PUT`,h),E.success("Offer cancelled successfully."),l(),i()}catch(h){console.error(h),b("Failed to cancel the offer. "+(h.message||""))}finally{o(!1)}}};return s?e.jsxs(d,{show:t,onHide:l,centered:!0,children:[e.jsx(d.Header,{closeButton:!0,children:e.jsx(d.Title,{children:"Cancel Job Offer"})}),e.jsxs(d.Body,{children:[j&&e.jsx(w,{variant:"danger",children:j}),e.jsxs("p",{children:["You are about to cancel the following offer:",e.jsx("br",{}),e.jsx("b",{children:s.job_title})," for candidate"," ",e.jsx("strong",{children:s.candidate_text||s.candidate_id})]}),e.jsx("hr",{}),e.jsxs(S.Group,{className:"mb-3",children:[e.jsx(S.Label,{className:"fw-semibold",children:"Reason / Message"}),e.jsx(S.Control,{as:"textarea",rows:3,placeholder:"Add a brief reason or message (optional)",value:c,onChange:h=>x(h.target.value)})]})]}),e.jsxs(d.Footer,{children:[e.jsx(f,{variant:"secondary",onClick:l,disabled:r,children:"Close"}),e.jsx(f,{variant:"danger",onClick:u,disabled:r,children:r?"Cancelling...":"Cancel Offer"})]})]}):null},ie=()=>{const[t,s]=n.useState([]),[l,i]=n.useState(!1),[c,x]=n.useState(""),[r,o]=n.useState(1),[j,b]=n.useState(1),[u,h]=n.useState(""),[R]=n.useState([]),[_,M]=n.useState(null),[k,T]=n.useState(!1),[P,J]=n.useState(null),[A,V]=n.useState(!1),g=n.useCallback(async(a,m)=>{i(!0),x("");try{const C={};m&&(C.search=m);const N=await se.fetchCompanyOffers(a,C);s(N.data),o(N.current_page),b(N.last_page)}catch(C){console.error(C),x("Failed to load job offers."),E.error("Error loading job offers.")}finally{i(!1)}},[]);n.useEffect(()=>{g(r,u)},[g,r,u]);const z=a=>{a.preventDefault(),o(1),g(1,u)},v=a=>{a>=1&&a<=j&&o(a)},H=a=>{M(a),T(!0)},I=()=>{T(!1),M(null)},L=a=>{J(a),V(!0)},B=()=>{V(!1),J(null)},G=()=>{B(),g(r,u)};return e.jsxs(e.Fragment,{children:[e.jsx(U,{breadcrumbs:[{title:"Company Job Offers",path:"/company-job-offers",isActive:!0}],children:"Company Job Offers"}),e.jsx(W,{}),e.jsxs(Y,{children:[e.jsx($.div,{className:"container-fluid py-4 card shadow-sm",variants:ae,initial:"hidden",animate:"visible",exit:"exit",children:e.jsxs("div",{className:"card-body",children:[e.jsx("form",{onSubmit:z,className:"row mb-3",autoComplete:"off",children:e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"input-group input-group-sm",children:[e.jsx("span",{className:"input-group-text bg-primary text-white",children:e.jsx(q,{})}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Search by candidate or job...",value:u,onChange:a=>h(a.target.value)}),e.jsx(f,{type:"submit",variant:"primary",children:"Search"})]})})}),l&&e.jsx("div",{className:"text-center py-5",children:e.jsx(Q,{animation:"border",variant:"primary"})}),!l&&c&&e.jsx(w,{variant:"danger",className:"text-center",children:c}),!l&&!c&&t.length===0&&e.jsx(w,{variant:"info",className:"text-center",children:"No job offers found."}),!l&&!c&&t.length>0&&e.jsx("div",{className:"table-responsive",children:e.jsxs(X,{striped:!0,hover:!0,className:"align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Job Title"}),e.jsx("th",{children:"Candidate"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:t.map((a,m)=>e.jsx(D,{offer:a,idx:m,currentPage:r,rowLoading:R.includes(m),onViewOffer:H,onCancelOffer:L},a.id))})]})}),!l&&!c&&j>1&&e.jsxs(y,{className:"mt-4 justify-content-center",children:[e.jsx(y.Prev,{onClick:()=>v(r-1),disabled:r<=1,children:"Previous"}),Array.from({length:j},(a,m)=>m+1).map(a=>e.jsx(y.Item,{active:a===r,onClick:()=>v(a),children:a},a)),e.jsx(y.Next,{onClick:()=>v(r+1),disabled:r>=j,children:"Next"})]})]})}),e.jsxs(Z,{children:[k&&_&&e.jsx(te,{show:k,offer:_,onClose:I}),A&&P&&e.jsx(ne,{show:A,offer:P,onClose:B,onCancelConfirmed:G})]})]})]})};export{ie as default};
