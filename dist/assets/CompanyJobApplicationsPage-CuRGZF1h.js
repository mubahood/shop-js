import{R as J,j as e,ap as Q,ai as g,p as v,r as a,K as D,af as X,ab as Z,ac as ee,z as se,aj as s,aq as H,ak as ne,ar as te,al as V,am as F,an as ae,ao as L,_ as re,M as m,as as c,L as ie}from"./index-D3ojX_Fy.js";import{M as le}from"./MyJonApplicationModel-B4KyBT13.js";import{R as u}from"./Row-CSwAd3hl.js";const oe={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.3}},exit:{opacity:0,y:10}},G=J.memo(({status:r})=>{let n="bg-light-secondary text-secondary",i="text-secondary";switch(r){case"Pending":n="bg-light-warning text-warning",i="text-warning";break;case"Interview":n="bg-light-info text-info",i="text-info";break;case"Hired":n="bg-light-success text-success",i="text-success";break;case"Declined":n="bg-light-danger text-danger",i="text-danger";break;case"On Hold":n="bg-light-primary text-primary",i="text-primary";break;case"Rejected":n="bg-light-danger text-danger",i="text-danger";break}return e.jsx(Q,{className:`badge ${n} ${i}`,children:r})});G.displayName="StatusBadge";const E=J.memo(({app:r,idx:n,currentPage:i,onOpenReviewModal:j,onOpenViewModal:t,isRowLoading:d})=>{var x;return e.jsxs("tr",{children:[e.jsx("td",{children:d?e.jsx(g,{}):(i-1)*10+(n+1)}),e.jsx("td",{children:d?e.jsx(g,{width:150}):e.jsx("a",{href:`/cv-bank/${r.employer_id}`,target:"_blank",rel:"noopener noreferrer",title:"Click to view applicant cv",children:r.employer_text||r.employer_id})}),e.jsx("td",{children:d?e.jsx(g,{width:150}):r.job_text||r.job_id}),e.jsx("td",{children:d?e.jsx(g,{width:80}):e.jsx(G,{status:r.status})}),e.jsx("td",{children:d?e.jsx(g,{width:100}):((x=r.created_at)==null?void 0:x.split("T")[0])||"N/A"}),e.jsx("td",{children:d?e.jsx(g,{width:120}):r.interview_scheduled_at?r.interview_scheduled_at.split("T")[0]:"N/A"}),e.jsxs("td",{className:"d-flex gap-1",children:[" ",d?e.jsx(g,{width:60}):e.jsx(v,{variant:"outline-primary",size:"sm",className:"btn-sm font-weight-bold",onClick:()=>t(r),children:"View Details"}),d?e.jsx(g,{width:60}):e.jsx(v,{variant:"primary",size:"sm",className:"btn-sm btn-primary font-weight-bold",onClick:()=>j(r),children:"Review"})]})]},r.id)});E.displayName="JobApplicationRow";const ce=({showModal:r,selectedApp:n,onCloseModal:i})=>{var j;return n?e.jsxs(m,{show:r,onHide:i,size:"lg",centered:!0,children:[e.jsx(m.Header,{closeButton:!0,children:e.jsxs(m.Title,{children:["Application Details: ",n.job_text||n.job_id]})}),e.jsxs(m.Body,{children:[e.jsxs("section",{className:"mb-4",children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-3",children:"Application Overview"}),e.jsxs(u,{children:[e.jsxs(c,{md:6,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",e.jsx(G,{status:n.status})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Applied On:"})," ",((j=n.created_at)==null?void 0:j.split("T")[0])||"N/A"]}),e.jsx("p",{children:e.jsx("strong",{children:"Applicant Message:"})}),e.jsx("div",{className:"card card-body bg-light-secondary rounded-sm",children:n.applicant_message||"No message"}),e.jsxs("p",{className:"mt-2",children:[e.jsx("strong",{children:"Attachments:"})," ",n.attachments||"None"]})]}),e.jsxs(c,{md:6,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Employer Message:"})," ",n.employer_message||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Decline Reason:"})," ",n.decline_reason||"N/A"]})]})]})]}),e.jsxs("section",{className:"mb-4",style:{borderTop:"1px solid #eee",paddingTop:"15px"},children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-3",children:"Interview Details"}),e.jsxs(u,{children:[e.jsxs(c,{md:6,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Scheduled At:"})," ",n.interview_scheduled_at?n.interview_scheduled_at.split("T")[0]:"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Location:"})," ",n.interview_location||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",n.interview_type||"N/A"]})]}),e.jsxs(c,{md:6,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Result:"})," ",n.interview_result||"Pending"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Interviewer Notes:"})," ",n.interviewer_notes||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Interviewer Rating:"})," ",n.interviewer_rating||"N/A"]})]})]})]}),e.jsxs("section",{className:"mb-4",style:{borderTop:"1px solid #eee",paddingTop:"15px"},children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-3",children:"Interviewee Feedback"}),e.jsxs(u,{children:[e.jsx(c,{md:6,children:e.jsxs("p",{children:[e.jsx("strong",{children:"Feedback to Interviewee:"})," ",n.interviewee_feedback||"N/A"]})}),e.jsx(c,{md:6,children:e.jsxs("p",{children:[e.jsx("strong",{children:"Interviewee Rating:"})," ",n.interviewee_rating||"N/A"]})})]})]}),e.jsxs("section",{className:"mb-4",style:{borderTop:"1px solid #eee",paddingTop:"15px"},children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-3",children:"Onboarding"}),e.jsxs(u,{children:[e.jsx(c,{md:6,children:e.jsxs("p",{children:[e.jsx("strong",{children:"Contract URL:"})," ",n.contract_url||"N/A"]})}),e.jsxs(c,{md:6,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Onboarding Start:"})," ",n.onboarding_start_date||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Onboarding Notes:"})," ",n.onboarding_notes||"N/A"]})]})]})]})]}),e.jsx(m.Footer,{children:e.jsx(v,{variant:"secondary",onClick:i,children:"Close"})})]}):null},de=({showModal:r,selectedApp:n,onCloseModal:i,onApplicationUpdate:j})=>{const[t,d]=a.useState(n),[x,_]=a.useState(!1),[h,N]=a.useState(null);a.useEffect(()=>{d(n)},[n]);const o=b=>{b.target},M=b=>{o(b)},p=async()=>{if(t){_(!0),N(null);try{var b=await ie(`/job-application-update/${t.id}`,t);console.log("=============================="),console.log(b),console.log("=============================="),D.success("Application updated successfully!"),i(),j()}catch(C){console.error("Error updating application:",C),N("Failed to update application. because "+C),D.error("Failed to update application because "+C)}finally{_(!1)}}};if(!t)return null;const f=t.status,S=["Declined","Rejected"].includes(f),k=["Interview","Hired","Declined","Rejected","On Hold"].includes(f),A=["Hired","Declined","Rejected"].includes(f),R=f==="Hired";return e.jsxs(m,{show:r,onHide:i,size:"lg",centered:!0,children:[e.jsx(m.Header,{closeButton:!0,className:"bg-primary text-white",children:e.jsxs(m.Title,{className:"text-white",children:["Review Application: ",t.job_text||t.job_id]})}),e.jsxs(m.Body,{className:"p-4",children:[h&&e.jsx(F,{variant:"danger",children:h}),e.jsxs(s,{children:[e.jsxs("section",{className:"mb-6",children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-4",children:"Application Status"}),e.jsxs(u,{className:"mb-3 align-items-stretch",children:[e.jsx(c,{md:6,children:e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Current Status"})}),e.jsxs(s.Select,{name:"status",value:t.status,onChange:M,className:"form-control form-control-outline",children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Interview",children:"Interview"}),e.jsx("option",{value:"Hired",children:"Hired"}),e.jsx("option",{value:"Declined",children:"Declined"}),e.jsx("option",{value:"On Hold",children:"On Hold"}),e.jsx("option",{value:"Rejected",children:"Rejected"})]})]})}),S&&e.jsx(c,{md:6,children:e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Decline/Reject Reason"})}),e.jsx(s.Control,{as:"textarea",rows:3,name:"decline_reason",value:t.decline_reason||"",onChange:o,placeholder:"Reason for decline/rejection (internal use)",className:"form-control form-control-outline"})]})})]})]}),e.jsxs("section",{className:"mb-6",children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-4",children:"Applicant Information"}),e.jsxs(u,{className:"mb-3",children:[e.jsxs(c,{md:6,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{className:"text-dark",children:"Applicant Message:"}),e.jsx("p",{className:"text-muted card card-body bg-light-secondary rounded-sm",children:t.applicant_message||"No message"})]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-dark",children:"Attachments:"}),e.jsx("p",{className:"text-muted",children:t.attachments||"None"})]})]}),e.jsx(c,{md:6,children:e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Employer Message to Applicant"})}),e.jsx(s.Control,{as:"textarea",rows:3,name:"employer_message",value:t.employer_message||"",onChange:o,placeholder:"Optional message to applicant",className:"form-control form-control-outline"})]})})]})]}),k&&e.jsxs("section",{className:"mb-6",children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-4",children:"Interview Details"}),e.jsxs(u,{children:[e.jsxs(c,{md:6,children:[e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Scheduled At"})}),e.jsx(s.Control,{type:"datetime-local",name:"interview_scheduled_at",value:t.interview_scheduled_at?t.interview_scheduled_at.slice(0,16):"",onChange:o,className:"form-control form-control-outline"})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Location"})}),e.jsx(s.Control,{type:"text",name:"interview_location",value:t.interview_location||"",onChange:o,placeholder:"Interview Location",className:"form-control form-control-outline"})]})]}),e.jsxs(c,{md:6,children:[e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Interview Type"})}),e.jsxs(s.Select,{name:"interview_type",value:t.interview_type||"",onChange:o,className:"form-control form-control-outline",children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"In-person",children:"In-person"}),e.jsx("option",{value:"Virtual",children:"Virtual"}),e.jsx("option",{value:"Phone",children:"Phone"})]})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Interviewer Notes"})}),e.jsx(s.Control,{as:"textarea",rows:3,name:"interviewer_notes",value:t.interviewer_notes||"",onChange:o,placeholder:"Notes from the interviewer",className:"form-control form-control-outline"})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Interview Result"})}),e.jsx(s.Control,{type:"text",name:"interview_result",value:t.interview_result||"",onChange:o,placeholder:"Interview Result",className:"form-control form-control-outline"})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Interviewer Rating"})}),e.jsx(s.Control,{type:"text",name:"interviewer_rating",value:t.interviewer_rating||"",onChange:o,placeholder:"Rating given by interviewer",className:"form-control form-control-outline"})]})]})]})]}),A&&e.jsxs("section",{className:"mb-6",children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-4",children:"Interviewee Feedback"}),e.jsxs(u,{children:[e.jsx(c,{md:6,children:e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Feedback to Interviewee"})}),e.jsx(s.Control,{as:"textarea",rows:3,name:"interviewee_feedback",value:t.interviewee_feedback||"",onChange:o,placeholder:"Feedback for the interviewee",className:"form-control form-control-outline"})]})}),e.jsx(c,{md:6,children:e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Interviewee Rating"})}),e.jsx(s.Control,{type:"text",name:"interviewee_rating",value:t.interviewee_rating||"",onChange:o,placeholder:"Rating given by interviewee (if collected)",className:"form-control form-control-outline"})]})})]})]}),R&&e.jsxs("section",{className:"mb-6",children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-4",children:"Onboarding"}),e.jsxs(u,{children:[e.jsx(c,{md:6,children:e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Contract URL"})}),e.jsx(s.Control,{type:"text",name:"contract_url",value:t.contract_url||"",onChange:o,placeholder:"URL of the contract document",className:"form-control form-control-outline"})]})}),e.jsxs(c,{md:6,children:[e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Onboarding Start Date"})}),e.jsx(s.Control,{type:"date",name:"onboarding_start_date",value:t.onboarding_start_date||"",onChange:o,className:"form-control form-control-outline"})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Onboarding Notes"})}),e.jsx(s.Control,{as:"textarea",rows:2,name:"onboarding_notes",value:t.onboarding_notes||"",onChange:o,placeholder:"Any onboarding notes",className:"form-control form-control-outline"})]})]})]})]})]})]}),e.jsxs(m.Footer,{className:"border-top pt-4",children:[e.jsx(v,{variant:"primary",onClick:p,disabled:x,className:"btn-primary font-weight-bold",children:x?e.jsx(V,{size:"sm",animation:"border"}):"Update Application"}),e.jsx(v,{variant:"secondary",onClick:i,disabled:x,className:"btn-secondary font-weight-bold ml-2",children:"Close"})]})]})},pe=()=>{const[r,n]=a.useState([]),[i,j]=a.useState(!1),[t,d]=a.useState(!1),[x,_]=a.useState(""),[h,N]=a.useState(1),[o,M]=a.useState(1),[p,f]=a.useState(""),[S,k]=a.useState(!1),[A,R]=a.useState(!1),[b,C]=a.useState(null),[P,U]=a.useState(null),[B,he]=a.useState([]),y=a.useCallback(async(l,w)=>{j(!0),_("");try{const I={};w&&(I.search=w);const O=await le.fetchCompanyJobs(l,I);n(O.data),N(O.current_page),M(O.last_page)}catch(I){console.error(I),_("Failed to load job applications."),D.error("Error loading applications.")}finally{j(!1)}},[]);a.useEffect(()=>{y(h,p)},[h,p,y]);const z=a.useCallback(l=>{l.preventDefault(),N(1),y(1,p)},[p,y]),T=a.useCallback(l=>{l>=1&&l<=o&&N(l)},[o]),$=a.useCallback(l=>{C(l),k(!0)},[]),q=a.useCallback(()=>{k(!1)},[]),K=a.useCallback(l=>{U(l),R(!0)},[]),W=a.useCallback(()=>{R(!1)},[]),Y=a.useCallback(()=>{d(!0),y(h,p).finally(()=>d(!1))},[h,p,y]);return e.jsxs(e.Fragment,{children:[e.jsx(X,{breadcrumbs:[{title:"Jobs",path:"/admin/company-job-applications",isActive:!1}],children:"Company - Job Applications"}),e.jsx(Z,{}),e.jsx(ee,{children:e.jsx(se.div,{className:"container-fluid py-4 card shadow-sm",variants:oe,initial:"hidden",animate:"visible",exit:"exit",children:e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-md-4",children:e.jsx(s,{onSubmit:z,children:e.jsxs(H,{size:"sm",children:[e.jsx(H.Text,{className:"bg-primary border-primary text-white",children:e.jsx(ne,{color:"white"})}),e.jsx(te,{type:"text",placeholder:"Search...",value:p,onChange:l=>f(l.target.value)}),e.jsx(v,{variant:"primary",type:"submit",size:"sm"}),e.jsx(v,{variant:"primary",type:"submit",className:"btn-primary font-weight-bold",children:"Search"})]})})})}),(i||t)&&e.jsx("div",{className:"text-center py-5",children:e.jsx(V,{animation:"border",variant:"primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}),!i&&x&&e.jsx(F,{variant:"danger",role:"alert",children:x}),!i&&!x&&r.length===0&&e.jsx("div",{className:"d-flex flex-column align-items-center justify-content-center py-5",children:e.jsxs(F,{variant:"info",className:"text-center w-50",children:[e.jsx("h4",{className:"font-weight-bold",children:"No Job Applications Found"}),e.jsx("p",{className:"mb-4",children:"You haven't applied for any jobs yet."}),e.jsx(v,{href:"/jobs",as:"a",variant:"primary",className:"btn-primary font-weight-bold",children:"Browse Jobs"})]})}),!i&&!x&&r.length>0&&e.jsx("div",{className:"table-responsive",children:e.jsxs(ae,{striped:!0,hover:!0,className:"align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Applicant"}),e.jsx("th",{children:"Job"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Applied On"}),e.jsx("th",{children:"Interview Date"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:r.map((l,w)=>e.jsx(E,{app:l,idx:w,currentPage:h,onOpenReviewModal:$,onOpenViewModal:K,isRowLoading:B.includes(w)},l.id))})]})}),!i&&!x&&o>1&&e.jsxs(L,{className:"mt-4 justify-content-center",children:[e.jsx(L.Prev,{onClick:()=>T(h-1),disabled:h<=1,className:"pagination-prev next-link",children:"Previous"}),Array.from({length:o},(l,w)=>w+1).map(l=>e.jsx(L.Item,{active:l===h,onClick:()=>T(l),className:"page-item",children:l},l)),e.jsx(L.Next,{onClick:()=>T(h+1),disabled:h>=o,className:"pagination-next next-link",children:"Next"})]}),e.jsxs(re,{children:[S&&b&&e.jsx(de,{showModal:S,selectedApp:b,onCloseModal:q,onApplicationUpdate:Y}),A&&P&&e.jsx(ce,{showModal:A,selectedApp:P,onCloseModal:W})]})]})})})]})};export{pe as default};
