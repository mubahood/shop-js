var C=Object.defineProperty;var _=(o,r,e)=>r in o?C(o,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[r]=e;var d=(o,r,e)=>_(o,typeof r!="symbol"?r+"":r,e);import{ag as v,L as V,r as h,j as t,ai as u,K as R,af as k,ac as F,ab as J,z as A,al as L,am as S,an as M,ao as x}from"./index-D3ojX_Fy.js";class p{constructor(){d(this,"id","");d(this,"created_at","");d(this,"updated_at","");d(this,"type","");d(this,"viewer_id","");d(this,"item_id","");d(this,"company_id","");d(this,"viewer_text","");d(this,"item_text","");d(this,"company_text","")}updateRecord(r){Object.assign(this,r)}toJSON(){const r={};for(const e in this)Object.prototype.hasOwnProperty.call(this,e)&&(r[e]=this[e]);return r}static fromJson(r){const e=new p;let a=typeof r=="string"?{}:r;if(typeof r=="string")try{a=JSON.parse(r)}catch{return e}const s=Object.keys(e);for(const n of Object.keys(a))s.includes(n)&&(e[n]=a[n]);return e}static async fetchMyViewRecords(r=1,e={}){try{const a=new URLSearchParams({page:String(r),...Object.fromEntries(Object.entries(e).map(([i,m])=>[i,String(m)]))}),s=await v(`/view-records?${a.toString()}`);if(s.code!==1)throw new Error(s.message||"Failed to fetch view records.");const n=s.data;return n.data=n.data.map(i=>p.fromJson(i)),n}catch(a){throw console.error("Error fetching my view records:",a),a}}static async fetchCompanyViewRecords(r=1,e={}){try{const a=new URLSearchParams({page:String(r),...Object.fromEntries(Object.entries(e).map(([i,m])=>[i,String(m)]))}),s=await v(`/company-view-records?${a.toString()}`);if(s.code!==1)throw new Error(s.message||"Failed to fetch company view records.");const n=s.data;return n.data=n.data.map(i=>p.fromJson(i)),n}catch(a){throw console.error("Error fetching company view records:",a),a}}static async createViewRecord(r){try{const e=await V("/view-record-create",r);if(e.code!==1)throw new Error(e.message||"Failed to create view record.");return p.fromJson(e.data)}catch(e){throw console.error("Error creating view record:",e),e}}}const T={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.3}},exit:{opacity:0,y:10}},N=h.memo(({record:o,idx:r,currentPage:e,rowLoading:a})=>{const s=(e-1)*10+(r+1);return t.jsxs("tr",{children:[t.jsx("td",{children:a?t.jsx(u,{}):s}),t.jsx("td",{children:a?t.jsx(u,{width:120}):o.viewer_text||o.viewer_id||"N/A"}),t.jsx("td",{children:a?t.jsx(u,{width:100}):o.created_at?o.created_at.split("T")[0]:"N/A"})]})});N.displayName="ViewRecordRow";const $=()=>{const[o,r]=h.useState([]),[e,a]=h.useState(!1),[s,n]=h.useState(""),[i,m]=h.useState(1),[w,E]=h.useState(1),b=h.useCallback(async c=>{a(!0),n("");try{const l={type:"CV"},P=new URLSearchParams({page:String(c),...Object.fromEntries(Object.entries(l).map(([g,O])=>[g,String(O)]))}),j=await v(`/view-records?${P.toString()}`);if(j.code!==1)throw new Error(j.message||"Failed to fetch view records.");const y=j.data;y.data=y.data.map(g=>p.fromJson(g)),r(y.data),m(y.current_page),E(y.last_page)}catch(l){console.error("Error fetching view records:",l),n(l.message||"Failed to load view records."),R.error(l.message||"Failed to load view records.")}finally{a(!1)}},[]);h.useEffect(()=>{b(i)},[b,i]);const f=c=>{c>=1&&c<=w&&m(c)};return t.jsxs(t.Fragment,{children:[t.jsx(k,{breadcrumbs:[{title:"My CV Views",path:"/my-cv-views",isActive:!0}],children:"My CV Views"}),t.jsxs(F,{children:[t.jsx(J,{}),t.jsx(A.div,{className:"container-fluid card py-4 card shadow-sm",variants:T,initial:"hidden",animate:"visible",exit:"exit",children:t.jsxs("div",{className:"card-body",children:[e&&t.jsx("div",{className:"text-center py-5",children:t.jsx(L,{animation:"border",variant:"primary"})}),!e&&s&&t.jsx(S,{variant:"danger",className:"text-center",children:s}),!e&&!s&&o.length===0&&t.jsx(S,{variant:"info",className:"text-center",children:"No CV views recorded yet."}),!e&&!s&&o.length>0&&t.jsx("div",{className:"table-responsive",children:t.jsxs(M,{striped:!0,hover:!0,className:"align-middle",children:[t.jsx("thead",{className:"table-light",children:t.jsxs("tr",{children:[t.jsx("th",{style:{width:"50px"},children:"#"}),t.jsx("th",{children:"Viewer"}),t.jsx("th",{children:"Viewed On"})]})}),t.jsx("tbody",{children:o.map((c,l)=>t.jsx(N,{record:c,idx:l,currentPage:i,rowLoading:!1},c.id))})]})}),!e&&!s&&w>1&&t.jsxs(x,{className:"mt-4 justify-content-center",children:[t.jsx(x.Prev,{onClick:()=>f(i-1),disabled:i===1,children:"Previous"}),Array.from({length:w},(c,l)=>l+1).map(c=>t.jsx(x.Item,{active:c===i,onClick:()=>f(c),children:c},c)),t.jsx(x.Next,{onClick:()=>f(i+1),disabled:i===w,children:"Next"})]})]})}),t.jsx("style",{children:`
        .card {
          border-radius: 8px;
        }
        .card-header {
          font-family: Arial, sans-serif;
        }
        @media print {
          .card {
            box-shadow: none;
            border: none;
          }
        }
      `})]})]})};export{$ as default};
