import{bo as Y,r as a,j as e,z as E,aI as Z,J as $,ad as Q,bp as ee,bq as se,K as te}from"./index-UmL11Jau.js";const _={hidden:{opacity:0,x:-20},visible:{opacity:1,x:0,transition:{duration:.4}}},H=20,ae=({product:t})=>{const[x,l]=a.useState(!1),c=t.getMainImage()||Z("media/products/placeholder.png"),n=t.getHoverImage()||c,{addToCart:f,isInCart:i}=$(),j=i(t.id.toString()),o=u=>{u.preventDefault(),u.stopPropagation(),f({id:t.id.toString(),price:parseFloat(t.price_1),name:t.name,mainImage:c})};return e.jsx("div",{className:"col d-flex",children:e.jsx("div",{className:"card product-card rounded-3 shadow-sm border-0 d-flex flex-column w-100",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:e.jsxs(Q,{to:`/product/${t.id}`,className:"text-decoration-none text-dark d-flex flex-column h-100",children:[e.jsxs("div",{className:"img-wrapper position-relative overflow-hidden rounded-top-3",children:[e.jsx(ee,{src:x?n:c,alt:t.name}),e.jsx("button",{className:"add-cart-btn",onClick:o,children:j?e.jsx("i",{className:"bi bi-cart-check"}):e.jsx("i",{className:"bi bi-cart-plus"})})]}),e.jsxs("div",{className:"card-body flex-grow-1 d-flex flex-column p-3 bg-white",children:[e.jsx("h5",{className:"product-title mb-3",children:t.name}),e.jsx("div",{className:"mt-auto d-flex justify-content-between align-items-center",children:e.jsx("span",{className:"price-text",children:t.getFormattedPrice()})})]})]})})})},le=()=>{const[t,x]=Y(),[l,c]=a.useState(Number(t.get("page"))||1),[n,f]=a.useState(t.get("category")||""),[i,j]=a.useState(t.get("brand")||""),[o,u]=a.useState(t.get("color")||""),[d,C]=a.useState(t.get("size")||""),[m,k]=a.useState(t.get("rating")||""),[v,A]=a.useState(t.get("inStock")==="1"),[N,F]=a.useState(t.get("sort")||"Newest"),[h,O]=a.useState(t.get("minPrice")||""),[p,z]=a.useState(t.get("maxPrice")||""),[S,R]=a.useState([]),[b,I]=a.useState(!1),[g,L]=a.useState(""),[w,U]=a.useState(1),[M,D]=a.useState(0),G=["Phones","Laptops","Headphones","Cameras"],T=["Apple","Samsung","Dell","HP","Canon","Sony"],X=["Black","White","Blue","Red"],q=["S","M","L","XL"],J=["1","2","3","4","5"],K=["Newest","Price Low","Price High"],y=async s=>{I(!0),L("");try{const r={page:s,per_page:H,sort:N};n&&(r.category=n),i&&(r.brand=i),o&&(r.color=o),d&&(r.size=d),m&&(r.rating=m),v&&(r.in_stock=1),h&&(r.min_price=h),p&&(r.max_price=p);const P=await se.fetchProducts(s,r);R(P.data),U(P.last_page),D(P.total)}catch{L("Failed to load products."),te.error("Failed to load products.")}finally{I(!1)}};a.useEffect(()=>{y(l)},[n,i,o,d,m,v,N,h,p,l]);const V=()=>{c(1);const s={};n&&(s.category=n),i&&(s.brand=i),o&&(s.color=o),d&&(s.size=d),m&&(s.rating=m),v&&(s.inStock="1"),h&&(s.minPrice=h),p&&(s.maxPrice=p),s.sort=N,s.page="1",x(s,{replace:!0}),y(1)},W=()=>{f(""),j(""),u(""),C(""),k(""),A(!1),O(""),z(""),F("Newest"),c(1),x({},{replace:!0}),y(1)},B=s=>{if(s<1||s>w)return;c(s);const r=Object.fromEntries([...t]);r.page=String(s),x(r,{replace:!0}),y(s)};return e.jsxs("div",{className:"container py-4 px-2 px-lg-10",children:[e.jsxs("div",{className:"row gx-3",children:[e.jsx(E.div,{className:"col-12 col-md-3 mb-3",variants:_,initial:"hidden",animate:"visible",children:e.jsxs("div",{className:"bg-white rounded shadow-sm p-3",children:[e.jsxs("h6",{className:"fw-bold mb-3",children:[e.jsx("i",{className:"bi bi-funnel-fill me-2 text-primary"}),"Filters"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label mb-1",children:"Category"}),e.jsxs("select",{className:"form-select form-select-sm",value:n,onChange:s=>f(s.target.value),children:[e.jsx("option",{value:"",children:"All"}),G.map(s=>e.jsx("option",{children:s},s))]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label mb-1",children:"Brand"}),e.jsxs("select",{className:"form-select form-select-sm",value:i,onChange:s=>j(s.target.value),children:[e.jsx("option",{value:"",children:"All"}),T.map(s=>e.jsx("option",{children:s},s))]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label mb-1",children:"Color"}),e.jsxs("select",{className:"form-select form-select-sm",value:o,onChange:s=>u(s.target.value),children:[e.jsx("option",{value:"",children:"Any"}),X.map(s=>e.jsx("option",{children:s},s))]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label mb-1",children:"Size"}),e.jsxs("select",{className:"form-select form-select-sm",value:d,onChange:s=>C(s.target.value),children:[e.jsx("option",{value:"",children:"Any"}),q.map(s=>e.jsx("option",{children:s},s))]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label mb-1",children:"Rating"}),e.jsxs("select",{className:"form-select form-select-sm",value:m,onChange:s=>k(s.target.value),children:[e.jsx("option",{value:"",children:"Any"}),J.map(s=>e.jsxs("option",{children:[s," ★ & Up"]},s))]})]}),e.jsxs("div",{className:"form-check mb-3",children:[e.jsx("input",{id:"inStockOnly",type:"checkbox",className:"form-check-input",checked:v,onChange:s=>A(s.target.checked)}),e.jsx("label",{htmlFor:"inStockOnly",className:"form-check-label",children:"In Stock Only"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label mb-1",children:"Sort By"}),e.jsx("select",{className:"form-select form-select-sm",value:N,onChange:s=>F(s.target.value),children:K.map(s=>e.jsx("option",{children:s},s))})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label mb-1",children:"Price (UGX)"}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("input",{type:"number",className:"form-control form-control-sm",placeholder:"Min",value:h,onChange:s=>O(s.target.value)}),e.jsx("input",{type:"number",className:"form-control form-control-sm",placeholder:"Max",value:p,onChange:s=>z(s.target.value)})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{className:"btn btn-sm btn-primary flex-grow-1",onClick:V,children:"Apply"}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:W,children:"Clear"})]})]})}),e.jsxs("div",{className:"col-12 col-md-9",children:[e.jsxs(E.div,{className:"bg-white shadow-sm rounded p-3 mb-3 d-flex justify-content-between align-items-center",variants:_,initial:"hidden",animate:"visible",children:[e.jsx("h1",{className:"h4 mb-0",children:"Shop"}),e.jsxs("small",{className:"text-muted",children:[M," items"]})]}),b&&e.jsxs("div",{className:"py-4 text-center",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status"}),e.jsx("p",{className:"mt-2",children:"Loading products..."})]}),!b&&g&&e.jsx("div",{className:"alert alert-danger",children:g}),!b&&!g&&S.length===0&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-muted",children:"No products found."})}),!b&&!g&&S.length>0&&e.jsx("div",{className:"row row-cols-2 row-cols-md-3 row-cols-lg-4 gx-3 gy-4",children:S.map(s=>e.jsx(ae,{product:s},s.id))}),!b&&!g&&M>H&&e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-4",children:[e.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>B(l-1),disabled:l<=1,children:"‹ Prev"}),e.jsxs("span",{children:["Page ",l," of ",w]}),e.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>B(l+1),disabled:l>=w,children:"Next ›"})]})]})]}),e.jsx("style",{children:`
        .product-card { transition: transform 0.2s, box-shadow 0.2s; }
        .product-card:hover { transform: translateY(-3px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .img-wrapper { width:100%; padding-top:100%; position:relative; }
        .img-wrapper img, .img-wrapper .react-content-loader {
          position:absolute !important; top:0; left:0;
        }
        .add-cart-btn {
          position:absolute; top:8px; right:8px;
          background:rgba(255,255,255,0.85); border:none; border-radius:50%;
          width:36px; height:36px; display:flex; align-items:center; justify-content:center;
          opacity:0; transition:opacity 0.2s; color:#0517A1FF; font-size:1.1rem;
        }
        .product-card:hover .add-cart-btn { opacity:1; }
        .product-title {
          font-size:0.95rem; font-weight:500; line-height:1.3;
          display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical;
          overflow:hidden; margin-bottom:0; min-height:2.6rem;
        }
        .price-text { color:#0517A1FF; font-weight:600; font-size:1rem; }
      `})]})};export{le as default};
