import{j as e}from"./vendor-bootstrap-D-I_tXzc.js";import{r}from"./vendor-react-BEzjZhyF.js";import{O as i}from"./OrderModel-CProAc5Z.js";import{f as a}from"./index-B0HgjlNw.js";import{p as t,q as s,T as o}from"./index-UqLlkq5m.js";import"./vendor-redux-Dj4qHuPE.js";const n=()=>{const{orderId:n}=t(),c=s(),[d,l]=r.useState(null),[m,v]=r.useState(!0);r.useEffect((()=>{n&&g()}),[n]);const g=()=>{return e=void 0,r=null,a=function*(){try{v(!0);const e=(yield i.fetchItems()).find((e=>e.id.toString()===n));e?l(e):(o.error("Order not found"),c("/account/orders"))}catch(e){o.error("Failed to load order details"),c("/account/orders")}finally{v(!1)}},new Promise(((i,t)=>{var s=e=>{try{n(a.next(e))}catch(r){t(r)}},o=e=>{try{n(a.throw(e))}catch(r){t(r)}},n=e=>e.done?i(e.value):Promise.resolve(e.value).then(s,o);n((a=a.apply(e,r)).next())}));var e,r,a},h=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";if(m)return e.jsxs("div",{style:{textAlign:"center",padding:"var(--spacing-12) var(--spacing-4)"},children:[e.jsx("div",{style:{display:"inline-block",width:"40px",height:"40px",border:"4px solid var(--border-color)",borderTop:"4px solid var(--primary-color)",borderRadius:"50%",animation:"spin 1s linear infinite"}}),e.jsx("p",{style:{marginTop:"var(--spacing-3)",color:"var(--text-color-medium)",fontSize:"var(--font-size-base)"},children:"Loading order details..."})]});if(!d)return e.jsx("div",{className:"acc-card",style:{backgroundColor:"var(--warning-bg)",borderColor:"var(--warning-border)",color:"var(--warning-color)"},children:e.jsxs("div",{className:"acc-card-body",children:[e.jsx("i",{className:"bi bi-exclamation-triangle",style:{marginRight:"8px"}}),"Order not found.",e.jsx("button",{onClick:()=>c("/account/orders"),style:{background:"none",border:"none",color:"var(--primary-color)",textDecoration:"underline",cursor:"pointer",marginLeft:"4px"},children:"Return to orders"})]})});const p=(e=>{try{return JSON.parse(e||"[]")}catch(r){return[]}})(d.items);return e.jsxs("div",{className:"acc-order-details-container",children:[e.jsxs("div",{className:"acc-page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"acc-page-title",children:"Order Details"}),e.jsxs("p",{className:"acc-page-subtitle",children:["Invoice #",d.id," - ",h(d.created_at)]})]}),e.jsxs("button",{className:"acc-btn acc-btn-outline",onClick:()=>c("/account/orders"),children:[e.jsx("i",{className:"bi bi-arrow-left",style:{marginRight:"8px"}}),"Back to Orders"]})]}),e.jsx("div",{className:"acc-card",style:{marginBottom:"var(--spacing-6)"},children:e.jsx("div",{className:"acc-card-body",children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"var(--spacing-6)",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"2.5rem",fontWeight:"var(--font-weight-bold)",color:"var(--text-color)",marginBottom:"var(--spacing-2)"},children:a(parseFloat(d.payable_amount||d.order_total||"0"))}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-3)",marginBottom:"var(--spacing-2)"},children:[e.jsx("span",{style:{fontSize:"var(--font-size-sm)",fontWeight:"var(--font-weight-medium)",color:"var(--text-color-medium)"},children:"PAYMENT STATUS:"}),e.jsx("span",{style:{padding:"var(--spacing-1) var(--spacing-2)",fontSize:"var(--font-size-xs)",fontWeight:"var(--font-weight-medium)",borderRadius:"var(--border-radius)",backgroundColor:d.isPaid()?"var(--success-color)":"var(--danger-color)",color:"var(--white)"},children:d.isPaid()?"Paid":"Not Paid"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-3)"},children:[e.jsx("span",{style:{fontSize:"var(--font-size-sm)",fontWeight:"var(--font-weight-medium)",color:"var(--text-color-medium)"},children:"ORDER STATUS:"}),(r=>{const i={0:{text:"Pending",color:"var(--danger-color)"},1:{text:"Processing",color:"var(--warning-color)"},2:{text:"Completed",color:"var(--success-color)"},3:{text:"Canceled",color:"var(--text-color-medium)"},4:{text:"Failed",color:"var(--danger-color)"}}[r]||{text:r,color:"var(--text-color-medium)"};return e.jsx("span",{style:{padding:"var(--spacing-1) var(--spacing-2)",fontSize:"var(--font-size-xs)",fontWeight:"var(--font-weight-medium)",borderRadius:"var(--border-radius)",backgroundColor:i.color,color:"var(--white)",display:"inline-block"},children:i.text})})(d.order_state)]})]}),!d.isPaid()&&e.jsxs("div",{children:[e.jsxs("button",{className:"acc-btn acc-btn-primary acc-btn-lg",onClick:()=>{(null==d?void 0:d.isPaid)&&d.isPaid()?o.warning("This order has already been paid for!"):c(`/payment/${null==d?void 0:d.id}`)},style:{padding:"var(--spacing-3) var(--spacing-6)",fontSize:"var(--font-size-lg)",display:"flex",alignItems:"center",gap:"var(--spacing-2)",margin:"0 auto"},children:[e.jsx("i",{className:"bi bi-credit-card"}),"PAY NOW"]}),e.jsx("p",{style:{textAlign:"center",marginTop:"var(--spacing-2)",fontSize:"var(--font-size-sm)",color:"var(--text-color-medium)"},children:"Secure payment with Pesapal"})]})]})})}),e.jsxs("div",{style:{display:"grid",gap:"var(--spacing-4)"},children:[p&&p.length>0&&e.jsxs("div",{className:"acc-card",children:[e.jsx("div",{className:"acc-card-header",children:e.jsxs("h3",{className:"acc-card-title",children:[e.jsx("i",{className:"bi bi-bag-check"}),"Order Items (",p.length,")"]})}),e.jsxs("div",{className:"acc-card-body",children:[e.jsx("div",{style:{display:"grid",gap:"var(--spacing-3)"},children:p.map(((r,i)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"var(--spacing-3)",backgroundColor:"var(--background-light)",borderRadius:"var(--border-radius)",gap:"var(--spacing-3)"},children:[e.jsx("div",{style:{width:"60px",height:"60px",backgroundColor:"var(--white)",border:"1px solid var(--border-color)",borderRadius:"var(--border-radius)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx("i",{className:"bi bi-box",style:{color:"var(--text-color-medium)",fontSize:"1.5rem"}})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h6",{style:{fontSize:"var(--font-size-base)",fontWeight:"var(--font-weight-medium)",margin:0,marginBottom:"var(--spacing-1)"},children:r.product_name||r.name||"Product"}),e.jsxs("p",{style:{fontSize:"var(--font-size-sm)",color:"var(--text-color-medium)",margin:0},children:["Quantity: ",r.quantity||1," Ã— ",a(parseFloat(r.price||"0"))]})]}),e.jsx("div",{style:{fontSize:"var(--font-size-lg)",fontWeight:"var(--font-weight-bold)",color:"var(--text-color)"},children:a(parseFloat(r.quantity||"1")*parseFloat(r.price||"0"))})]},i)))}),e.jsxs("div",{style:{marginTop:"var(--spacing-4)",paddingTop:"var(--spacing-4)",borderTop:"1px solid var(--border-color)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"var(--spacing-2)"},children:[e.jsx("span",{children:"Order Items Total:"}),e.jsx("span",{children:a(parseFloat(d.order_total||"0"))})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"var(--spacing-2)"},children:[e.jsx("span",{children:"Delivery Cost:"}),e.jsx("span",{children:a(parseFloat(d.delivery_amount||"0"))})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:"var(--spacing-2)",borderTop:"1px solid var(--border-color)",fontSize:"var(--font-size-lg)",fontWeight:"var(--font-weight-bold)"},children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{children:a(parseFloat(d.payable_amount||d.order_total||"0"))})]})]})]})]}),e.jsxs("div",{className:"acc-card",children:[e.jsx("div",{className:"acc-card-header",children:e.jsxs("h3",{className:"acc-card-title",children:[e.jsx("i",{className:"bi bi-geo-alt"}),"Delivery Information"]})}),e.jsx("div",{className:"acc-card-body",children:e.jsxs("div",{style:{display:"grid",gap:"var(--spacing-3)"},children:[e.jsxs("div",{children:[e.jsx("h6",{style:{fontSize:"var(--font-size-sm)",fontWeight:"var(--font-weight-medium)",color:"var(--text-color)",marginBottom:"var(--spacing-1)"},children:"Delivery Address:"}),e.jsxs("p",{style:{color:"var(--text-color-medium)",margin:0,lineHeight:"1.5"},children:[d.delivery_address_text||d.customer_address||"Not specified",d.delivery_address_details&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),d.delivery_address_details]})]})]}),e.jsxs("div",{children:[e.jsx("h6",{style:{fontSize:"var(--font-size-sm)",fontWeight:"var(--font-weight-medium)",color:"var(--text-color)",marginBottom:"var(--spacing-1)"},children:"Delivery Method:"}),e.jsx("p",{style:{color:"var(--text-color-medium)",margin:0},children:d.delivery_method||"Standard Delivery"})]}),e.jsxs("div",{children:[e.jsx("h6",{style:{fontSize:"var(--font-size-sm)",fontWeight:"var(--font-weight-medium)",color:"var(--text-color)",marginBottom:"var(--spacing-1)"},children:"Delivery Cost:"}),e.jsx("p",{style:{color:"var(--text-color-medium)",margin:0,fontWeight:"var(--font-weight-medium)"},children:a(parseFloat(d.delivery_amount||"0"))})]})]})})]}),e.jsxs("div",{className:"acc-card",children:[e.jsx("div",{className:"acc-card-header",children:e.jsxs("h3",{className:"acc-card-title",children:[e.jsx("i",{className:"bi bi-person-lines-fill"}),"Contact Information"]})}),e.jsx("div",{className:"acc-card-body",children:e.jsxs("div",{style:{display:"grid",gap:"var(--spacing-3)"},children:[e.jsxs("div",{children:[e.jsx("h6",{style:{fontSize:"var(--font-size-sm)",fontWeight:"var(--font-weight-medium)",color:"var(--text-color)",marginBottom:"var(--spacing-1)"},children:"Customer Name:"}),e.jsx("p",{style:{color:"var(--text-color-medium)",margin:0},children:d.customer_name||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("h6",{style:{fontSize:"var(--font-size-sm)",fontWeight:"var(--font-weight-medium)",color:"var(--text-color)",marginBottom:"var(--spacing-1)"},children:"Email:"}),e.jsx("p",{style:{color:"var(--text-color-medium)",margin:0},children:d.mail||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("h6",{style:{fontSize:"var(--font-size-sm)",fontWeight:"var(--font-weight-medium)",color:"var(--text-color)",marginBottom:"var(--spacing-1)"},children:"Phone:"}),e.jsxs("p",{style:{color:"var(--text-color-medium)",margin:0},children:[d.customer_phone_number_1||"Not specified",d.customer_phone_number_2&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"Alt: ",d.customer_phone_number_2]})]})]}),(()=>{const r=(e=>{if(!e)return"";if(!e.trim().startsWith("{")&&!e.trim().startsWith("["))return e.trim();try{const r=JSON.parse(e);return"object"==typeof r&&null!==r?r.order_details||"":e.trim()}catch(r){return e.trim()}})(d.order_details||"");return r&&r.trim()?e.jsxs("div",{children:[e.jsx("h6",{style:{fontSize:"var(--font-size-sm)",fontWeight:"var(--font-weight-medium)",color:"var(--text-color)",marginBottom:"var(--spacing-1)"},children:"Order Notes:"}),e.jsx("p",{style:{color:"var(--text-color-medium)",margin:0,padding:"var(--spacing-3)",backgroundColor:"var(--background-light)",borderRadius:"var(--border-radius)",lineHeight:"1.5",whiteSpace:"pre-wrap"},children:r})]}):null})()]})})]}),e.jsxs("div",{className:"acc-card",children:[e.jsx("div",{className:"acc-card-header",children:e.jsxs("h3",{className:"acc-card-title",children:[e.jsx("i",{className:"bi bi-file-earmark-text"}),"Invoice Information"]})}),e.jsx("div",{className:"acc-card-body",children:e.jsxs("div",{style:{display:"grid",gap:"var(--spacing-3)"},children:[e.jsxs("div",{children:[e.jsx("h6",{style:{fontSize:"var(--font-size-sm)",fontWeight:"var(--font-weight-medium)",color:"var(--text-color)",marginBottom:"var(--spacing-1)"},children:"Invoice Number:"}),e.jsxs("p",{style:{color:"var(--text-color-medium)",margin:0,fontFamily:"monospace",fontSize:"var(--font-size-lg)"},children:["INVOICE-",d.id]})]}),e.jsxs("div",{children:[e.jsx("h6",{style:{fontSize:"var(--font-size-sm)",fontWeight:"var(--font-weight-medium)",color:"var(--text-color)",marginBottom:"var(--spacing-1)"},children:"Invoice Date:"}),e.jsx("p",{style:{color:"var(--text-color-medium)",margin:0},children:h(d.created_at)})]}),d.date_updated&&d.date_updated!==d.created_at&&e.jsxs("div",{children:[e.jsx("h6",{style:{fontSize:"var(--font-size-sm)",fontWeight:"var(--font-weight-medium)",color:"var(--text-color)",marginBottom:"var(--spacing-1)"},children:"Last Updated:"}),e.jsx("p",{style:{color:"var(--text-color-medium)",margin:0},children:h(d.date_updated)})]})]})})]})]}),e.jsx("style",{children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]})};export{n as default};
